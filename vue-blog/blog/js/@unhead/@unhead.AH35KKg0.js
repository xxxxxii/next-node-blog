import{c as t,g as e}from"../unhead/unhead.CbQJPbn2.js";import{n,v as o,u as r,i as s,r as i,w as a,a as l,o as c,b as d,c as p,g as u}from"../@vue/@vue.se5cR7rz.js";const f=["title","titleTemplate","script","style","noscript"],m=["base","meta","link","style","script","noscript"],y=["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"],g=["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"],h=["tagPosition","tagPriority","tagDuplicateStrategy","children","innerHTML","textContent","processTemplateParams"],b="undefined"!=typeof window;function v(t){return t}function $(t){let e=9;for(let n=0;n<t.length;)e=Math.imul(e^t.charCodeAt(n++),9**9);return(65536+(e^e>>>9)).toString(16).substring(1,8).toLowerCase()}function w(t){return t._h||$(t._d?t._d:`${t.tag}:${t.textContent||t.innerHTML||""}:${Object.entries(t.props).map((([t,e])=>`${t}:${String(e)}`)).join(",")}`)}function A(t,e){const{props:n,tag:o}=t;if(g.includes(o))return o;if("link"===o&&"canonical"===n.rel)return"canonical";if(n.charset)return"charset";const r=["id"];"meta"===o&&r.push("name","property","http-equiv");for(const s of r)if(void 0!==n[s]){return`${o}:${s}:${String(n[s])}`}return!1}function T(t,e){return null==t?e||null:"function"==typeof t?t(e):t}function _(t,e){var n;const o="class"===t?" ":";";return"object"!=typeof e||Array.isArray(e)||(e=Object.entries(e).filter((([,t])=>t)).map((([e,n])=>"style"===t?`${e}:${n}`:e))),null==(n=String(Array.isArray(e)?e.join(o):e))?void 0:n.split(o).filter((t=>t.trim())).filter(Boolean).join(o)}async function j(t,e){for(const n of Object.keys(t))if(["class","style"].includes(n))t[n]=_(n,t[n]);else if(t[n]instanceof Promise&&(t[n]=await t[n]),!e&&!h.includes(n)){const e=String(t[n]),o=n.startsWith("data-");"true"===e||""===e?t[n]=!o||"true":t[n]||(o&&"false"===e?t[n]="false":delete t[n])}return t}async function P(t){const e=[];return Object.entries(t.resolvedInput).filter((([t,e])=>void 0!==e&&y.includes(t))).forEach((([n,o])=>{const r=function(t){return Array.isArray(t)?t:[t]}(o);e.push(...r.map((e=>async function(t,e,n){const o={tag:t,props:await j("object"!=typeof e||"function"==typeof e||e instanceof Promise?{[["script","noscript","style"].includes(t)?"innerHTML":"textContent"]:e}:{...e},["templateParams","titleTemplate"].includes(t))};return h.forEach((t=>{const e=void 0!==o.props[t]?o.props[t]:n[t];void 0!==e&&(["innerHTML","textContent","children"].includes(t)&&!f.includes(o.tag)||(o["children"===t?"innerHTML":t]=e),delete o.props[t])})),o.props.body&&(o.tagPosition="bodyClose",delete o.props.body),"script"===o.tag&&"object"==typeof o.innerHTML&&(o.innerHTML=JSON.stringify(o.innerHTML),o.props.type=o.props.type||"application/json"),Array.isArray(o.props.content)?o.props.content.map((t=>({...o,props:{...o.props,content:t}}))):o}(n,e,t))).flat())})),(await Promise.all(e)).flat().filter(Boolean).map(((e,n)=>(e._e=t._i,t.mode&&(e._m=t.mode),e._p=(t._i<<10)+n,e)))}const L={base:-10,title:10},M={critical:-80,high:-10,low:20};function C(t){let e=100;const n=t.tagPriority;return"number"==typeof n?n:("meta"===t.tag?("content-security-policy"===t.props["http-equiv"]&&(e=-30),t.props.charset&&(e=-20),"viewport"===t.props.name&&(e=-15)):"link"===t.tag&&"preconnect"===t.props.rel?e=20:t.tag in L&&(e=L[t.tag]),"string"==typeof n&&n in M?e+M[n]:e)}const E=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}],H=["onload","onerror","onabort","onprogress","onloadstart"],O="%separator";function S(t,e,n){if("string"!=typeof t||!t.includes("%"))return t;let o=t;try{o=decodeURI(t)}catch{}return(o.match(/%(\w+\.+\w+)|%(\w+)/g)||[]).sort().reverse().forEach((n=>{const o=function(t){let n;return n=["s","pageTitle"].includes(t)?e.pageTitle:t.includes(".")?t.split(".").reduce(((t,e)=>t&&t[e]||void 0),e):e[t],void 0!==n&&(n||"").replace(/"/g,'\\"')}(n.slice(1));"string"==typeof o&&(t=t.replace(new RegExp(`\\${n}(\\W|$)`,"g"),((t,e)=>`${o}${e}`)).trim())})),t.includes(O)&&(t.endsWith(O)&&(t=t.slice(0,-10).trim()),t.startsWith(O)&&(t=t.slice(10).trim()),t=S(t=t.replace(new RegExp(`\\${O}\\s*\\${O}`,"g"),O),{separator:n},n)),t}async function k(t,e={}){const n=e.delayFn||(t=>setTimeout(t,10));return t._domUpdatePromise=t._domUpdatePromise||new Promise((o=>n((async()=>{await async function(t,e={}){var n;const o=e.document||t.resolvedOptions.document;if(!o||!t.dirty)return;const r={shouldRender:!0,tags:[]};if(await t.hooks.callHook("dom:beforeRender",r),!r.shouldRender)return;const s=(await t.resolveTags()).map((t=>({tag:t,id:m.includes(t.tag)?w(t):t.tag,shouldRender:!0})));let i=t._dom;if(!i){i={elMap:{htmlAttrs:o.documentElement,bodyAttrs:o.body}};for(const t of["body","head"]){const e=null==(n=o[t])?void 0:n.children,r=[];for(const t of[...e].filter((t=>m.includes(t.tagName.toLowerCase())))){const e={tag:t.tagName.toLowerCase(),props:await j(t.getAttributeNames().reduce(((e,n)=>({...e,[n]:t.getAttribute(n)})),{})),innerHTML:t.innerHTML};let n=1,o=A(e);for(;o&&r.find((t=>t._d===o));)o=`${o}:${n++}`;e._d=o||void 0,r.push(e),i.elMap[t.getAttribute("data-hid")||w(e)]=t}}}function a(t,e,n){const o=`${t}:${e}`;i.sideEffects[o]=n,delete i.pendingSideEffects[o]}function l({id:t,$el:e,tag:n}){const r=n.tag.endsWith("Attrs");i.elMap[t]=e,r||(["textContent","innerHTML"].forEach((t=>{n[t]&&n[t]!==e[t]&&(e[t]=n[t])})),a(t,"el",(()=>{var e;null==(e=i.elMap[t])||e.remove(),delete i.elMap[t]})));for(const[s,i]of Object.entries(n._eventHandlers||{}))""!==e.getAttribute(`data-${s}`)&&(("bodyAttrs"===n.tag?o.defaultView:e).addEventListener(s.replace("on",""),i.bind(e)),e.setAttribute(`data-${s}`,""));Object.entries(n.props).forEach((([n,o])=>{const s=`attr:${n}`;if("class"===n)for(const i of(o||"").split(" ").filter(Boolean))r&&a(t,`${s}:${i}`,(()=>e.classList.remove(i))),!e.classList.contains(i)&&e.classList.add(i);else if("style"===n)for(const r of(o||"").split(";").filter(Boolean)){const[n,...o]=r.split(":").map((t=>t.trim()));a(t,`${s}:${r}:${n}`,(()=>{e.style.removeProperty(n)})),e.style.setProperty(n,o.join(":"))}else e.getAttribute(n)!==o&&e.setAttribute(n,!0===o?"":String(o)),r&&a(t,s,(()=>e.removeAttribute(n)))}))}i.pendingSideEffects={...i.sideEffects||{}},i.sideEffects={};const c=[],d={bodyClose:void 0,bodyOpen:void 0,head:void 0};for(const p of s){const{tag:t,shouldRender:e,id:n}=p;e&&("title"!==t.tag?(p.$el=p.$el||i.elMap[n],p.$el?l(p):m.includes(t.tag)&&c.push(p)):o.title=t.textContent)}for(const p of c){const t=p.tag.tagPosition||"head";p.$el=o.createElement(p.tag.tag),l(p),d[t]=d[t]||o.createDocumentFragment(),d[t].appendChild(p.$el)}for(const p of s)await t.hooks.callHook("dom:renderTag",p,o,a);d.head&&o.head.appendChild(d.head),d.bodyOpen&&o.body.insertBefore(d.bodyOpen,o.body.firstChild),d.bodyClose&&o.body.appendChild(d.bodyClose),Object.values(i.pendingSideEffects).forEach((t=>t())),t._dom=i,t.dirty=!1,await t.hooks.callHook("dom:rendered",{renders:s})}(t,e),delete t._domUpdatePromise,o()}))))}function x(t){return e=>{var n,o;const r=(null==(o=null==(n=e.resolvedOptions.document)?void 0:n.head.querySelector('script[id="unhead:payload"]'))?void 0:o.innerHTML)||!1;return r&&e.push(JSON.parse(r)),{mode:"client",hooks:{"entries:updated":function(e){k(e,t)}}}}}const R=o.startsWith("3");function W(t,e=""){if(t instanceof Promise)return t;const n="function"==typeof(o=t)?o():r(o);var o;return t&&n?Array.isArray(n)?n.map((t=>W(t,e))):"object"==typeof n?Object.fromEntries(Object.entries(n).map((([t,e])=>"titleTemplate"===t||t.startsWith("on")?[t,r(e)]:[t,W(e,t)]))):n:n}const N={hooks:{"entries:resolve":function(t){for(const e of t.entries)e.resolvedInput=W(e.input)}}},B="usehead";function D(e={}){e.domDelayFn=e.domDelayFn||(t=>n((()=>setTimeout((()=>t()),0))));const o=t(e);return o.use(N),o.install=function(t){return{install(e){R&&(e.config.globalProperties.$unhead=t,e.config.globalProperties.$head=t,e.provide(B,t))}}.install}(o),o}const F="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},I="__unhead_injection_handler__";function U(t,n={}){const o=n.head||function(){if(I in F)return F[I]();const t=s(B);return t||e()}();if(o)return o.ssr?o.push(t,n):function(t,e,n={}){const o=i(!1),r=i({});a((()=>{r.value=o.value?{}:W(e)}));const s=t.push(r.value,n);l(r,(t=>{s.patch(t)}));u()&&(c((()=>{s.dispose()})),d((()=>{o.value=!0})),p((()=>{o.value=!1})));return s}(o,t,n)}export{x as D,m as H,b as I,H as N,E as S,C as a,D as c,v as d,$ as h,P as n,S as p,T as r,A as t,U as u};
